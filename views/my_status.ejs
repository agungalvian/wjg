<div class="card">
    <div class="card-header flex-between">
        <h3>Status Iuran Tahun <%= year %>
        </h3>
        <div class="header-actions no-print">
            <form action="/my-status" method="GET" class="year-filter">
                <select name="year" onchange="this.form.submit()" class="form-control">
                    <% for(let y=2024; y<=2027; y++) { %>
                        <option value="<%= y %>" <%=y==year ? 'selected' : '' %>><%= y %>
                        </option>
                        <% } %>
                </select>
            </form>
            <button onclick="window.print()" class="btn-print"><i class="fas fa-print"></i> Cetak</button>
        </div>
    </div>
    <div class="card-body">
        <div class="month-matrix">
            <% const monthNames=['Januari', 'Februari' , 'Maret' , 'April' , 'Mei' , 'Juni' , 'Juli' , 'Agustus'
                , 'September' , 'Oktober' , 'November' , 'Desember' ]; monthNames.forEach((name, index)=> {
                const monthKey = year + '-' + String(index + 1).padStart(2, '0');
                const isPaid = paymentMap[monthKey];
                %>
                <div class="month-status-card <%= isPaid ? 'paid' : 'unpaid' %>">
                    <div class="month-name">
                        <%= name %>
                    </div>
                    <div class="status-icon">
                        <% if (isPaid) { %>
                            <i class="fas fa-check-circle"></i>
                            <div class="status-text">Lunas</div>
                            <% } else { %>
                                <i class="fas fa-times-circle"></i>
                                <div class="status-text">Belum Bayar</div>
                                <% } %>
                    </div>
                </div>
                <% }); %>
        </div>

        <div class="status-legend mt-4">
            <div class="legend-item">
                <span class="legend-color paid"></span>
                <span>Sudah Lunas</span>
            </div>
            <div class="legend-item">
                <span class="legend-color unpaid"></span>
                <span>Belum Dibayar / Menunggu Verifikasi</span>
            </div>
        </div>

        <div class="mt-4 info-box">
            <p><i class="fas fa-info-circle"></i> <strong>Catatan:</strong> Status "Lunas" akan muncul setelah
                pembayaran Anda dikonfirmasi oleh Admin. Jika Anda sudah membayar namun status belum berubah, mohon
                tunggu proses verifikasi atau hubungi pengurus.</p>
            <a href="/my-payments" class="btn-primary-outline mt-2">Bayar Iuran Sekarang</a>
        </div>
    </div>
</div>

<style>
    .flex-between {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
    }

    .header-actions {
        display: flex;
        gap: 1rem;
        align-items: center;
    }

    .month-matrix {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
        gap: 1.5rem;
    }

    .month-status-card {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 1rem;
        padding: 1.5rem;
        text-align: center;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .month-status-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    }

    .month-status-card.paid {
        background: #f0fff4;
        border-color: #c6f6d5;
    }

    .month-status-card.unpaid {
        background: #fff5f5;
        border-color: #fed7d7;
    }

    .month-name {
        font-weight: 700;
        font-size: 1.1rem;
        margin-bottom: 1rem;
        color: #1e293b;
    }

    .status-icon {
        font-size: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
    }

    .paid .status-icon i {
        color: #48bb78;
    }

    .unpaid .status-icon i {
        color: #f56565;
    }

    .status-text {
        font-size: 0.9rem;
        font-weight: 600;
    }

    .status-legend {
        display: flex;
        gap: 2rem;
        padding: 1rem;
        background: #f1f5f9;
        border-radius: 0.5rem;
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
    }

    .legend-color {
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 0.25rem;
    }

    .legend-color.paid {
        background: #c6f6d5;
        border: 1px solid #48bb78;
    }

    .legend-color.unpaid {
        background: #fed7d7;
        border: 1px solid #f56565;
    }

    .info-box {
        background: #ebf8ff;
        border-left: 4px solid #4299e1;
        padding: 1.5rem;
        border-radius: 0.5rem;
    }

    .btn-primary-outline {
        display: inline-block;
        padding: 0.5rem 1rem;
        border: 1px solid #667eea;
        color: #667eea;
        text-decoration: none;
        border-radius: 0.5rem;
        font-weight: 600;
        transition: all 0.2s;
    }

    .btn-primary-outline:hover {
        background: #667eea;
        color: white;
    }

    .btn-print {
        background: #4a5568;
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
    }

    @media print {

        .no-print,
        .sidebar,
        .top-bar,
        .mobile-header {
            display: none !important;
        }

        .main-content {
            padding: 0 !important;
        }

        .card {
            box-shadow: none !important;
            border: none !important;
        }
    }

    @media (max-width: 600px) {
        .month-matrix {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
        }

        .month-status-card {
            padding: 1rem;
        }

        .status-legend {
            flex-direction: column;
            gap: 1rem;
        }
    }
</style>